
{{ config(
    cluster_by = "_airbyte_extracted_at",
    partition_by = {"field": "_airbyte_extracted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_raw_id'
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ source('cta', 'registrant_matches') }}

select
   _airbyte_raw_id,
   _airbyte_extracted_at,
   _airbyte_meta,
   id,
   age,
   dwid,
   race,
   zip9,
   state,
   gender,
   reg_city,
   reg_zip4,
   reg_zip5,
   birthdate,
   cass_city,
   ethnicity,
   full_name,
   last_name,
   reg_state,
   type_code,
   cass_state,
   created_at,
   first_name,
   updated_at,
   county_name,
   likely_cell,
   middle_name,
   name_suffix,
   race_source,
   applicant_id,
   cass_zipcode,
   mailing_city,
   mailing_zip4,
   mailing_zip5,
   phone_number,
   mailing_state,
   precinct_code,
   precinct_name,
   election_cycle,
   household_id_1,
   household_id_2,
   cass_state_fips,
   likely_landline,
   race_confidence,
   reg_address_one,
   reg_address_two,
   cass_county_fips,
   confidence_score,
   registration_date,
   voter_file_version,
   cass_street_address,
   mailing_address_one,
   mailing_address_two,
   registration_form_id,
   unique_precinct_code,
   reg_address_unit_type,
   change_of_address_date,
   likely_cell_restricted,
   reg_address_street_name,
   reg_address_street_type,
   reg_address_unit_number,
   mailing_address_unit_type,
   reg_address_street_number,
   earliest_registration_date,
   likely_landline_restricted,
   voter_file_acqusition_date,
   mailing_address_street_name,
   mailing_address_street_type,
   mailing_address_unit_number,
   reg_address_pre_directional,
   likely_cell_assignment_score,
   reg_address_post_directional,
   mailing_address_street_number,
   likely_cell_connectivity_score,
   mailing_address_pre_directional,
   likely_landline_assignment_score,
   mailing_address_post_directional,
   likely_landline_connectivity_score,
   voter_file_latest_registration_date,
   {{ dbt_utils.surrogate_key([
     'id',
    'age',
    'dwid',
    'race',
    'zip9',
    'state',
    'gender',
    'reg_city',
    'reg_zip4',
    'reg_zip5',
    'birthdate',
    'cass_city',
    'ethnicity',
    'full_name',
    'last_name',
    'reg_state',
    'type_code',
    'cass_state',
    'first_name',
    'county_name',
    'likely_cell',
    'middle_name',
    'name_suffix',
    'race_source',
    'applicant_id',
    'cass_zipcode',
    'mailing_city',
    'mailing_zip4',
    'mailing_zip5',
    'phone_number',
    'mailing_state',
    'precinct_code',
    'precinct_name',
    'election_cycle',
    'household_id_1',
    'household_id_2',
    'cass_state_fips',
    'likely_landline',
    'race_confidence',
    'reg_address_one',
    'reg_address_two',
    'cass_county_fips',
    'registration_date',
    'voter_file_version',
    'cass_street_address',
    'mailing_address_one',
    'mailing_address_two',
    'registration_form_id',
    'unique_precinct_code',
    'reg_address_unit_type',
    'change_of_address_date',
    'likely_cell_restricted',
    'reg_address_street_name',
    'reg_address_street_type',
    'reg_address_unit_number',
    'mailing_address_unit_type',
    'reg_address_street_number',
    'earliest_registration_date',
    'likely_landline_restricted',
    'voter_file_acqusition_date',
    'mailing_address_street_name',
    'mailing_address_street_type',
    'mailing_address_unit_number',
    'reg_address_pre_directional',
    'likely_cell_assignment_score',
    'reg_address_post_directional',
    'mailing_address_street_number',
    'likely_cell_connectivity_score',
    'mailing_address_pre_directional',
    'likely_landline_assignment_score',
    'mailing_address_post_directional',
    'likely_landline_connectivity_score',
    'voter_file_latest_registration_date'
    ]) }} as _airbyte_registrant_matches_hashid
from {{ source('cta', 'registrant_matches') }}
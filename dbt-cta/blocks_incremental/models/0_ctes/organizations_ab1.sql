{{ config(
    cluster_by = "_airbyte_extracted_at",
    partition_by = {"field": "_airbyte_extracted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_raw_id'
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ source('cta', 'organizations') }}

select
    _airbyte_raw_id,
    _airbyte_extracted_at,
    _airbyte_meta,
    street_address,
    notes,
    city,
    extras,
    created_at,
    denominations,
    leader_id,
    issues,
    mailing_zipcode,
    soft_member_count,
    updated_at,
    turf_id,
    id,
    state,
    membership_type_legacy,
    slug,
    membership_type,
    mailing_city,
    website,
    contact_name,
    mailing_state,
    address_id,
    active,
    created_by_user_id,
    zipcode,
    name,
    organization_type,
    phone_number,
    members_count,
    influence_level,
    mailing_street_address,
   {{ dbt_utils.surrogate_key([
     'street_address',
    'notes',
    'city',
    'extras',
    'denominations',
    'leader_id',
    'issues',
    'mailing_zipcode',
    'soft_member_count',
    'turf_id',
    'id',
    'state',
    'membership_type_legacy',
    'slug',
    'membership_type',
    'mailing_city',
    'website',
    'contact_name',
    'mailing_state',
    'address_id',
    'active',
    'created_by_user_id',
    'zipcode',
    'name',
    'organization_type',
    'phone_number',
    'members_count',
    'influence_level',
    'mailing_street_address'
    ]) }} as _airbyte_organizations_hashid
from {{ source('cta', 'organizations') }}

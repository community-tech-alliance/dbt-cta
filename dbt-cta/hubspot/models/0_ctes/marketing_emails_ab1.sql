{{ config(
    cluster_by = "_airbyte_extracted_at",
    partition_by = {"field": "_airbyte_extracted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_raw_id'
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ source('cta', 'marketing_emails') }}

select
    _airbyte_raw_id,
    _airbyte_extracted_at,
    _airbyte_meta,
    _airbyte_generation_id,
    ab,
    id,
    url,
    name,
    slug,
    state,
    stats,
    author,
    domain,
    created,
    replyTo,
    subject,
    updated,
    abStatus,
    archived,
    authorAt,
    campaign,
    folderId,
    fromName,
    language,
    portalId,
    sections,
    selected,
    emailBody,
    emailNote,
    emailType,
    flexAreas,
    htmlTitle,
    rootMicId,
    teamPerms,
    userPerms,
    aifeatures,
    archivedAt,
    authorName,
    categoryId,
    clonedFrom,
    createPage,
    freezeDate,
    leadFlowId,
    liveDomain,
    previewKey,
    abVariation,
    absoluteUrl,
    campaignUtm,
    createdById,
    isPublished,
    publishDate,
    publishedAt,
    rssEmailUrl,
    subcategory,
    updatedById,
    authorUserId,
    campaignName,
    currentState,
    publishedUrl,
    subscription,
    templatePath,
    translations,
    vidsExcluded,
    vidsIncluded,
    visibleToAll,
    abHoursToWait,
    blogEmailType,
    customReplyTo,
    maxRssEntries,
    publishedById,
    securityState,
    styleSettings,
    transactional,
    unpublishedAt,
    audienceAccess,
    layoutSections,
    pageRedirected,
    resolvedDomain,
    rssEmailByText,
    abSuccessMetric,
    analyticsPageId,
    blogRssSettings,
    metaDescription,
    publishedByName,
    abTestPercentage,
    feedbackSurveyId,
    lastEditUpdateId,
    processingStatus,
    publishedByEmail,
    smartEmailFields,
    subscriptionName,
    abSamplingDefault,
    analyticsPageType,
    canSpamSettingsId,
    emailTemplateMode,
    lastEditSessionId,
    pageExpiryEnabled,
    currentlyPublished,
    emailbodyPlaintext,
    publishImmediately,
    abSampleSizeDefault,
    allEmailCampaignIds,
    archivedInDashboard,
    contentTypeCategory,
    isLocalTimezoneSend,
    rssEmailCommentText,
    contentAccessRuleIds,
    customReplyToEnabled,
    emailCampaignGroupId,
    isInstanceLayoutPage,
    mailingListsExcluded,
    mailingListsIncluded,
    pastMabExperimentIds,
    feedbackEmailCategory,
    hasContentAccessRules,
    rssEmailImageMaxWidth,
    contentAccessRuleTypes,
    primaryEmailCampaignId,
    isCreatedFomSandboxSync,
    mailingIlsListsExcluded,
    mailingIlsListsIncluded,
    useRssHeadlineAsSubject,
    rssEmailClickThroughText,
    isGraymailSuppressionEnabled,
    rssEmailEntryTemplateEnabled,
    isRecipientFatigueSuppressionEnabled,
   {{ dbt_utils.surrogate_key([
     'ab',
    'id',
    'url',
    'name',
    'slug',
    'state',
    'author',
    'domain',
    'created',
    'replyTo',
    'subject',
    'updated',
    'abStatus',
    'archived',
    'authorAt',
    'campaign',
    'folderId',
    'fromName',
    'language',
    'portalId',
    'selected',
    'emailBody',
    'emailNote',
    'emailType',
    'htmlTitle',
    'rootMicId',
    'archivedAt',
    'authorName',
    'categoryId',
    'clonedFrom',
    'createPage',
    'freezeDate',
    'leadFlowId',
    'liveDomain',
    'previewKey',
    'abVariation',
    'absoluteUrl',
    'campaignUtm',
    'createdById',
    'isPublished',
    'publishDate',
    'publishedAt',
    'rssEmailUrl',
    'subcategory',
    'updatedById',
    'authorUserId',
    'campaignName',
    'currentState',
    'publishedUrl',
    'subscription',
    'templatePath',
    'visibleToAll',
    'abHoursToWait',
    'blogEmailType',
    'customReplyTo',
    'maxRssEntries',
    'publishedById',
    'securityState',
    'transactional',
    'unpublishedAt',
    'audienceAccess',
    'pageRedirected',
    'resolvedDomain',
    'rssEmailByText',
    'abSuccessMetric',
    'analyticsPageId',
    'blogRssSettings',
    'metaDescription',
    'publishedByName',
    'abTestPercentage',
    'feedbackSurveyId',
    'lastEditUpdateId',
    'processingStatus',
    'publishedByEmail',
    'subscriptionName',
    'abSamplingDefault',
    'analyticsPageType',
    'canSpamSettingsId',
    'emailTemplateMode',
    'lastEditSessionId',
    'pageExpiryEnabled',
    'currentlyPublished',
    'emailbodyPlaintext',
    'publishImmediately',
    'abSampleSizeDefault',
    'archivedInDashboard',
    'contentTypeCategory',
    'isLocalTimezoneSend',
    'rssEmailCommentText',
    'customReplyToEnabled',
    'emailCampaignGroupId',
    'isInstanceLayoutPage',
    'feedbackEmailCategory',
    'hasContentAccessRules',
    'rssEmailImageMaxWidth',
    'primaryEmailCampaignId',
    'isCreatedFomSandboxSync',
    'useRssHeadlineAsSubject',
    'rssEmailClickThroughText',
    'isGraymailSuppressionEnabled',
    'rssEmailEntryTemplateEnabled',
    'isRecipientFatigueSuppressionEnabled'
    ]) }} as _airbyte_marketing_emails_hashid
from {{ source('cta', 'marketing_emails') }}

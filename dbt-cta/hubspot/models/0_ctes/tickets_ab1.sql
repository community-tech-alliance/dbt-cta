
{{ config(
    cluster_by = "_airbyte_extracted_at",
    partition_by = {"field": "_airbyte_extracted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_raw_id'
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ source('cta', 'tickets') }}

select
   _airbyte_raw_id,
   _airbyte_extracted_at,
   _airbyte_meta,
   _airbyte_generation_id,
   id,
   deals,
   archived,
   contacts,
   companies,
   createdAt,
   updatedAt,
   properties,
   properties_tags,
   properties_content,
   properties_program,
   properties_subject,
   properties_inbox_id,
   properties_language,
   properties_nps_score,
   properties_num_notes,
   properties_created_by,
   properties_createdate,
   properties_hs_tag_ids,
   properties_source_ref,
   properties_closed_date,
   properties_hs_inbox_id,
   properties_hs_pipeline,
   properties_source_type,
   properties_hs_object_id,
   properties_hs_read_only,
   properties_hs_ticket_id,
   properties_hs_time_in_1,
   properties_hs_time_in_2,
   properties_hs_time_in_3,
   properties_hs_time_in_4,
   properties_hs_createdate,
   properties_hs_resolution,
   properties_time_to_close,
   properties_hs_file_upload,
   properties_hs_in_helpdesk,
   properties_hs_all_team_ids,
   properties_hs_custom_inbox,
   properties_hs_was_imported,
   properties_hubspot_team_id,
   properties_last_reply_date,
   properties_hs_all_owner_ids,
   properties_hs_date_exited_1,
   properties_hs_date_exited_2,
   properties_hs_date_exited_3,
   properties_hs_date_exited_4,
   properties_hs_email_subject,
   properties_hs_lastcontacted,
   properties_hs_object_source,
   properties_hubspot_owner_id,
   properties_source_thread_id,
   properties_contract_end_date,
   properties_hs_date_entered_1,
   properties_hs_date_entered_2,
   properties_hs_date_entered_3,
   properties_hs_date_entered_4,
   properties_hs_pipeline_stage,
   properties_hs_last_email_date,
   properties_hs_primary_company,
   properties_hs_ticket_category,
   properties_hs_ticket_priority,
   properties_notes_last_updated,
   properties_action_needed_notes,
   properties_authentication_code,
   properties_hs_lastactivitydate,
   properties_hs_lastmodifieddate,
   properties_hs_nextactivitydate,
   properties_hs_object_source_id,
   properties_hs_time_in_95356465,
   properties_hs_time_in_95356466,
   properties_hs_time_in_95356467,
   properties_hs_time_in_95356468,
   properties_hs_time_in_96106531,
   properties_num_contacted_notes,
   properties_hs_assigned_team_ids,
   properties_hs_assignment_method,
   properties_hs_merged_object_ids,
   properties_hs_seen_by_agent_ids,
   properties_hs_time_in_110976592,
   properties_hs_time_in_110976593,
   properties_hs_time_in_110976594,
   properties_hs_time_in_110976595,
   properties_hs_time_in_135812689,
   properties_hs_time_in_136582039,
   properties_hs_time_in_137604385,
   properties_last_engagement_date,
   properties_notes_last_contacted,
   properties_nps_follow_up_answer,
   properties_hs_created_by_user_id,
   properties_hs_msteams_message_id,
   properties_hs_primary_company_id,
   properties_hs_updated_by_user_id,
   properties_first_agent_reply_date,
   properties_hs_external_object_ids,
   properties_hs_last_email_activity,
   properties_hs_latest_message_text,
   properties_hs_num_times_contacted,
   properties_hs_object_source_label,
   properties_hs_unique_creation_key,
   properties_hs_date_exited_95356465,
   properties_hs_date_exited_95356466,
   properties_hs_date_exited_95356467,
   properties_hs_date_exited_95356468,
   properties_hs_date_exited_96106531,
   properties_hs_last_message_sent_at,
   properties_hs_pinned_engagement_id,
   properties_hs_primary_company_name,
   properties_hs_time_to_close_sla_at,
   properties_hs_date_entered_95356465,
   properties_hs_date_entered_95356466,
   properties_hs_date_entered_95356467,
   properties_hs_date_entered_95356468,
   properties_hs_date_entered_96106531,
   properties_hs_date_exited_110976592,
   properties_hs_date_exited_110976593,
   properties_hs_date_exited_110976594,
   properties_hs_date_exited_110976595,
   properties_hs_date_exited_135812689,
   properties_hs_date_exited_136582039,
   properties_hs_date_exited_137604385,
   properties_hs_object_source_user_id,
   properties_hs_thread_ids_to_restore,
   properties_notes_next_activity_date,
   properties_hs_date_entered_110976592,
   properties_hs_date_entered_110976593,
   properties_hs_date_entered_110976594,
   properties_hs_date_entered_110976595,
   properties_hs_date_entered_135812689,
   properties_hs_date_entered_136582039,
   properties_hs_date_entered_137604385,
   properties_hs_most_relevant_sla_type,
   properties_hs_object_source_detail_1,
   properties_hs_object_source_detail_2,
   properties_hs_object_source_detail_3,
   properties_hs_user_ids_of_all_owners,
   properties_time_to_first_agent_reply,
   properties_hs_all_accessible_team_ids,
   properties_hs_helpdesk_sort_timestamp,
   properties_hs_is_visible_in_help_desk,
   properties_hubspot_owner_assigneddate,
   properties_hs_feedback_last_ces_rating,
   properties_hs_is_latest_message_failed,
   properties_hs_last_message_received_at,
   properties_hs_most_relevant_sla_status,
   properties_hs_notes_next_activity_type,
   properties_hs_num_associated_companies,
   properties_hs_sales_email_last_replied,
   properties_hs_time_to_close_sla_status,
   properties_hs_all_conversation_mentions,
   properties_hs_feedback_last_survey_date,
   properties_hs_last_message_from_visitor,
   properties_hs_applied_sla_rule_config_at,
   properties_hs_feedback_last_ces_follow_up,
   properties_hs_first_agent_message_sent_at,
   properties_hs_help_desk_onboarding_ticket,
   properties_nps_follow_up_question_version,
   properties_hs_num_associated_conversations,
   properties_hs_time_to_next_response_sla_at,
   properties_hs_all_associated_contact_emails,
   properties_hs_all_associated_contact_phones,
   properties_hs_auto_generated_from_thread_id,
   properties_hs_time_to_first_response_sla_at,
   properties_hs_originating_generic_channel_id,
   properties_hs_latest_message_attachment_types,
   properties_hs_originating_channel_instance_id,
   properties_hs_originating_email_engagement_id,
   properties_hs_all_associated_contact_companies,
   properties_hs_all_associated_contact_lastnames,
   properties_hs_latest_message_is_thread_comment,
   properties_hs_latest_message_seen_by_agent_ids,
   properties_hs_time_to_next_response_sla_status,
   properties_hs_all_associated_contact_firstnames,
   properties_hs_is_latest_message_hidden_from_all,
   properties_hs_latest_message_is_forwarded_email,
   properties_hs_latest_message_visible_to_visitor,
   properties_hs_time_to_first_response_sla_status,
   properties_hs_all_associated_contact_mobilephones,
   properties_hs_conversations_originating_thread_id,
   properties_hs_conversations_originating_message_id,
   properties_hs_user_ids_of_all_notification_followers,
   properties_hs_user_ids_of_all_notification_unfollowers,
   {{ dbt_utils.surrogate_key([
     'id',
    'archived',
    'createdAt',
    'updatedAt',
    'properties_tags',
    'properties_content',
    'properties_program',
    'properties_subject',
    'properties_inbox_id',
    'properties_language',
    'properties_nps_score',
    'properties_createdate',
    'properties_hs_tag_ids',
    'properties_source_ref',
    'properties_closed_date',
    'properties_hs_pipeline',
    'properties_source_type',
    'properties_hs_read_only',
    'properties_hs_createdate',
    'properties_hs_resolution',
    'properties_hs_file_upload',
    'properties_hs_in_helpdesk',
    'properties_hs_all_team_ids',
    'properties_hs_was_imported',
    'properties_hubspot_team_id',
    'properties_last_reply_date',
    'properties_hs_all_owner_ids',
    'properties_hs_date_exited_1',
    'properties_hs_date_exited_2',
    'properties_hs_date_exited_3',
    'properties_hs_date_exited_4',
    'properties_hs_email_subject',
    'properties_hs_lastcontacted',
    'properties_hs_object_source',
    'properties_hubspot_owner_id',
    'properties_source_thread_id',
    'properties_contract_end_date',
    'properties_hs_date_entered_1',
    'properties_hs_date_entered_2',
    'properties_hs_date_entered_3',
    'properties_hs_date_entered_4',
    'properties_hs_pipeline_stage',
    'properties_hs_last_email_date',
    'properties_hs_primary_company',
    'properties_hs_ticket_category',
    'properties_hs_ticket_priority',
    'properties_notes_last_updated',
    'properties_action_needed_notes',
    'properties_authentication_code',
    'properties_hs_lastactivitydate',
    'properties_hs_lastmodifieddate',
    'properties_hs_nextactivitydate',
    'properties_hs_object_source_id',
    'properties_hs_assigned_team_ids',
    'properties_hs_assignment_method',
    'properties_hs_merged_object_ids',
    'properties_hs_seen_by_agent_ids',
    'properties_last_engagement_date',
    'properties_notes_last_contacted',
    'properties_nps_follow_up_answer',
    'properties_hs_msteams_message_id',
    'properties_first_agent_reply_date',
    'properties_hs_external_object_ids',
    'properties_hs_last_email_activity',
    'properties_hs_latest_message_text',
    'properties_hs_object_source_label',
    'properties_hs_unique_creation_key',
    'properties_hs_date_exited_95356465',
    'properties_hs_date_exited_95356466',
    'properties_hs_date_exited_95356467',
    'properties_hs_date_exited_95356468',
    'properties_hs_date_exited_96106531',
    'properties_hs_last_message_sent_at',
    'properties_hs_primary_company_name',
    'properties_hs_time_to_close_sla_at',
    'properties_hs_date_entered_95356465',
    'properties_hs_date_entered_95356466',
    'properties_hs_date_entered_95356467',
    'properties_hs_date_entered_95356468',
    'properties_hs_date_entered_96106531',
    'properties_hs_date_exited_110976592',
    'properties_hs_date_exited_110976593',
    'properties_hs_date_exited_110976594',
    'properties_hs_date_exited_110976595',
    'properties_hs_date_exited_135812689',
    'properties_hs_date_exited_136582039',
    'properties_hs_date_exited_137604385',
    'properties_hs_thread_ids_to_restore',
    'properties_notes_next_activity_date',
    'properties_hs_date_entered_110976592',
    'properties_hs_date_entered_110976593',
    'properties_hs_date_entered_110976594',
    'properties_hs_date_entered_110976595',
    'properties_hs_date_entered_135812689',
    'properties_hs_date_entered_136582039',
    'properties_hs_date_entered_137604385',
    'properties_hs_most_relevant_sla_type',
    'properties_hs_object_source_detail_1',
    'properties_hs_object_source_detail_2',
    'properties_hs_object_source_detail_3',
    'properties_hs_user_ids_of_all_owners',
    'properties_hs_all_accessible_team_ids',
    'properties_hs_helpdesk_sort_timestamp',
    'properties_hs_is_visible_in_help_desk',
    'properties_hubspot_owner_assigneddate',
    'properties_hs_feedback_last_ces_rating',
    'properties_hs_is_latest_message_failed',
    'properties_hs_last_message_received_at',
    'properties_hs_most_relevant_sla_status',
    'properties_hs_notes_next_activity_type',
    'properties_hs_sales_email_last_replied',
    'properties_hs_time_to_close_sla_status',
    'properties_hs_all_conversation_mentions',
    'properties_hs_feedback_last_survey_date',
    'properties_hs_last_message_from_visitor',
    'properties_hs_applied_sla_rule_config_at',
    'properties_hs_feedback_last_ces_follow_up',
    'properties_hs_first_agent_message_sent_at',
    'properties_hs_help_desk_onboarding_ticket',
    'properties_hs_time_to_next_response_sla_at',
    'properties_hs_all_associated_contact_emails',
    'properties_hs_all_associated_contact_phones',
    'properties_hs_time_to_first_response_sla_at',
    'properties_hs_originating_generic_channel_id',
    'properties_hs_latest_message_attachment_types',
    'properties_hs_originating_channel_instance_id',
    'properties_hs_all_associated_contact_companies',
    'properties_hs_all_associated_contact_lastnames',
    'properties_hs_latest_message_is_thread_comment',
    'properties_hs_latest_message_seen_by_agent_ids',
    'properties_hs_time_to_next_response_sla_status',
    'properties_hs_all_associated_contact_firstnames',
    'properties_hs_is_latest_message_hidden_from_all',
    'properties_hs_latest_message_is_forwarded_email',
    'properties_hs_latest_message_visible_to_visitor',
    'properties_hs_time_to_first_response_sla_status',
    'properties_hs_all_associated_contact_mobilephones',
    'properties_hs_conversations_originating_message_id',
    'properties_hs_user_ids_of_all_notification_followers',
    'properties_hs_user_ids_of_all_notification_unfollowers'
    ]) }} as _airbyte_tickets_hashid
from {{ source('cta', 'tickets') }}
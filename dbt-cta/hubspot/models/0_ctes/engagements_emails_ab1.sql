
{{ config(
    cluster_by = "_airbyte_extracted_at",
    partition_by = {"field": "_airbyte_extracted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_raw_id'
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ source('cta', 'engagements_emails') }}

select
   _airbyte_raw_id,
   _airbyte_extracted_at,
   _airbyte_meta,
   _airbyte_generation_id,
   id,
   deals,
   tickets,
   archived,
   contacts,
   companies,
   createdAt,
   updatedAt,
   properties,
   properties_hs_object_id,
   properties_hs_read_only,
   properties_hs_timestamp,
   properties_hs_unique_id,
   properties_hs_created_by,
   properties_hs_createdate,
   properties_hs_email_html,
   properties_hs_email_text,
   properties_hs_modified_by,
   properties_hs_all_team_ids,
   properties_hs_body_preview,
   properties_hs_email_cc_raw,
   properties_hs_email_status,
   properties_hs_email_to_raw,
   properties_hs_gdpr_deleted,
   properties_hs_owner_ids_cc,
   properties_hs_owner_ids_to,
   properties_hs_product_name,
   properties_hs_scs_audit_id,
   properties_hs_was_imported,
   properties_hubspot_team_id,
   properties_hs_all_owner_ids,
   properties_hs_email_bcc_raw,
   properties_hs_email_headers,
   properties_hs_email_subject,
   properties_hs_object_source,
   properties_hs_owner_ids_bcc,
   properties_hubspot_owner_id,
   properties_hs_attachment_ids,
   properties_hs_email_cc_email,
   properties_hs_email_from_raw,
   properties_hs_email_sent_via,
   properties_hs_email_to_email,
   properties_hs_owner_ids_from,
   properties_hs_email_bcc_email,
   properties_hs_email_direction,
   properties_hs_email_thread_id,
   properties_hs_shared_team_ids,
   properties_hs_shared_user_ids,
   properties_hs_email_from_email,
   properties_hs_email_message_id,
   properties_hs_email_open_count,
   properties_hs_email_sender_raw,
   properties_hs_email_sent_count,
   properties_hs_follow_up_action,
   properties_hs_lastmodifieddate,
   properties_hs_object_source_id,
   properties_hs_body_preview_html,
   properties_hs_email_cc_lastname,
   properties_hs_email_click_count,
   properties_hs_email_logged_from,
   properties_hs_email_reply_count,
   properties_hs_email_to_lastname,
   properties_hs_email_tracker_key,
   properties_hs_engagement_source,
   properties_hs_merged_object_ids,
   properties_hs_created_by_user_id,
   properties_hs_email_bcc_lastname,
   properties_hs_email_cc_firstname,
   properties_hs_email_sender_email,
   properties_hs_email_to_firstname,
   properties_hs_updated_by_user_id,
   properties_hs_email_bcc_firstname,
   properties_hs_email_error_message,
   properties_hs_email_from_lastname,
   properties_hs_email_send_event_id,
   properties_hs_object_source_label,
   properties_hs_unique_creation_key,
   properties_hs_email_from_firstname,
   properties_hs_email_thread_summary,
   properties_hs_engagement_source_id,
   properties_hs_queue_membership_ids,
   properties_hs_email_sender_lastname,
   properties_hs_object_source_user_id,
   properties_hs_at_mentioned_owner_ids,
   properties_hs_email_ms_teams_payload,
   properties_hs_email_post_send_status,
   properties_hs_email_sender_firstname,
   properties_hs_object_source_detail_1,
   properties_hs_object_source_detail_2,
   properties_hs_object_source_detail_3,
   properties_hs_scs_association_status,
   properties_hs_user_ids_of_all_owners,
   properties_hs_all_accessible_team_ids,
   properties_hs_direction_and_unique_id,
   properties_hs_email_attached_video_id,
   properties_hs_email_facsimile_send_id,
   properties_hubspot_owner_assigneddate,
   properties_hs_email_validation_skipped,
   properties_hs_body_preview_is_truncated,
   properties_hs_email_attached_video_name,
   properties_hs_email_attached_video_opened,
   properties_hs_email_send_event_id_created,
   properties_hs_email_attached_video_watched,
   properties_hs_email_recipient_drop_reasons,
   properties_hs_email_media_processing_status,
   properties_hs_all_assigned_business_unit_ids,
   properties_hs_email_pending_inline_image_ids,
   properties_hs_email_stripped_attachment_count,
   properties_hs_email_has_inline_images_stripped,
   properties_hs_email_bounce_error_detail_message,
   properties_hs_email_member_of_forwarded_subthread,
   properties_hs_email_bounce_error_detail_status_code,
   properties_hs_user_ids_of_all_notification_followers,
   properties_hs_email_encoded_email_associations_request,
   properties_hs_email_migrated_via_portal_data_migration,
   properties_hs_user_ids_of_all_notification_unfollowers,
   {{ dbt_utils.surrogate_key([
     'id',
    'archived',
    'createdAt',
    'updatedAt',
    'properties_hs_read_only',
    'properties_hs_timestamp',
    'properties_hs_unique_id',
    'properties_hs_created_by',
    'properties_hs_createdate',
    'properties_hs_email_html',
    'properties_hs_email_text',
    'properties_hs_modified_by',
    'properties_hs_all_team_ids',
    'properties_hs_body_preview',
    'properties_hs_email_cc_raw',
    'properties_hs_email_status',
    'properties_hs_email_to_raw',
    'properties_hs_gdpr_deleted',
    'properties_hs_owner_ids_cc',
    'properties_hs_owner_ids_to',
    'properties_hs_product_name',
    'properties_hs_scs_audit_id',
    'properties_hs_was_imported',
    'properties_hubspot_team_id',
    'properties_hs_all_owner_ids',
    'properties_hs_email_bcc_raw',
    'properties_hs_email_headers',
    'properties_hs_email_subject',
    'properties_hs_object_source',
    'properties_hs_owner_ids_bcc',
    'properties_hubspot_owner_id',
    'properties_hs_attachment_ids',
    'properties_hs_email_cc_email',
    'properties_hs_email_from_raw',
    'properties_hs_email_sent_via',
    'properties_hs_email_to_email',
    'properties_hs_owner_ids_from',
    'properties_hs_email_bcc_email',
    'properties_hs_email_direction',
    'properties_hs_email_thread_id',
    'properties_hs_shared_team_ids',
    'properties_hs_shared_user_ids',
    'properties_hs_email_from_email',
    'properties_hs_email_message_id',
    'properties_hs_email_sender_raw',
    'properties_hs_follow_up_action',
    'properties_hs_lastmodifieddate',
    'properties_hs_object_source_id',
    'properties_hs_body_preview_html',
    'properties_hs_email_cc_lastname',
    'properties_hs_email_logged_from',
    'properties_hs_email_to_lastname',
    'properties_hs_email_tracker_key',
    'properties_hs_engagement_source',
    'properties_hs_merged_object_ids',
    'properties_hs_email_bcc_lastname',
    'properties_hs_email_cc_firstname',
    'properties_hs_email_sender_email',
    'properties_hs_email_to_firstname',
    'properties_hs_email_bcc_firstname',
    'properties_hs_email_error_message',
    'properties_hs_email_from_lastname',
    'properties_hs_email_send_event_id',
    'properties_hs_object_source_label',
    'properties_hs_unique_creation_key',
    'properties_hs_email_from_firstname',
    'properties_hs_email_thread_summary',
    'properties_hs_engagement_source_id',
    'properties_hs_queue_membership_ids',
    'properties_hs_email_sender_lastname',
    'properties_hs_at_mentioned_owner_ids',
    'properties_hs_email_ms_teams_payload',
    'properties_hs_email_post_send_status',
    'properties_hs_email_sender_firstname',
    'properties_hs_object_source_detail_1',
    'properties_hs_object_source_detail_2',
    'properties_hs_object_source_detail_3',
    'properties_hs_scs_association_status',
    'properties_hs_user_ids_of_all_owners',
    'properties_hs_all_accessible_team_ids',
    'properties_hs_direction_and_unique_id',
    'properties_hs_email_attached_video_id',
    'properties_hs_email_facsimile_send_id',
    'properties_hubspot_owner_assigneddate',
    'properties_hs_email_validation_skipped',
    'properties_hs_body_preview_is_truncated',
    'properties_hs_email_attached_video_name',
    'properties_hs_email_attached_video_opened',
    'properties_hs_email_send_event_id_created',
    'properties_hs_email_attached_video_watched',
    'properties_hs_email_recipient_drop_reasons',
    'properties_hs_email_media_processing_status',
    'properties_hs_all_assigned_business_unit_ids',
    'properties_hs_email_pending_inline_image_ids',
    'properties_hs_email_has_inline_images_stripped',
    'properties_hs_email_bounce_error_detail_message',
    'properties_hs_email_member_of_forwarded_subthread',
    'properties_hs_user_ids_of_all_notification_followers',
    'properties_hs_email_encoded_email_associations_request',
    'properties_hs_email_migrated_via_portal_data_migration',
    'properties_hs_user_ids_of_all_notification_unfollowers'
    ]) }} as _airbyte_engagements_emails_hashid
from {{ source('cta', 'engagements_emails') }}
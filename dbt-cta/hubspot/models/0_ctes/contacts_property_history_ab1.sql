
{{ config(
    cluster_by = "_airbyte_extracted_at",
    partition_by = {"field": "_airbyte_extracted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_raw_id'
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ source('cta', 'contacts_property_history') }}

select
   _airbyte_raw_id,
   _airbyte_extracted_at,
   _airbyte_meta,
   _airbyte_generation_id,
   vid,
   value,
   property,
   selected,
   portal_id,
   source_id,
   timestamp,
   is_contact,
   properties,
   source_type,
   source_vids,
   source_label,
   canonical_vid,
   properties_fax,
   properties_zip,
   properties_city,
   properties_email,
   properties_phone,
   properties_state,
   properties_degree,
   properties_gender,
   properties_opt_in,
   properties_school,
   properties_address,
   properties_company,
   properties_country,
   properties_ip_city,
   properties_message,
   properties_vendors,
   properties_website,
   updated_by_user_id,
   properties_inbox_id,
   properties_industry,
   properties_ip_state,
   properties_jobtitle,
   properties_lastname,
   properties_utm_term,
   properties_closedate,
   properties_deal_type,
   properties_firstname,
   properties_ip_latlon,
   properties_num_notes,
   properties_seniority,
   properties_createdate,
   properties_hs_persona,
   properties_ip_country,
   properties_ip_zipcode,
   properties_phone_type,
   properties_salutation,
   properties_start_date,
   properties_summer_pay,
   properties_utm_medium,
   properties_utm_source,
   properties_vip_status,
   properties_work_email,
   properties_deal_source,
   properties_hs_language,
   properties_hs_pipeline,
   properties_hs_timezone,
   properties_link_clicks,
   properties_mobilephone,
   properties_opt_in_date,
   properties_reported_by,
   properties_utm_content,
   properties_carrier_name,
   properties_company_size,
   properties_country_code,
   properties_hs_object_id,
   properties_hs_read_only,
   properties_hs_testpurge,
   properties_hubspotscore,
   properties_job_function,
   properties_numemployees,
   properties_opt_out_date,
   properties_program_name,
   properties_program_year,
   properties_utm_campaign,
   properties_annualrevenue,
   properties_date_of_birth,
   properties_days_to_close,
   properties_hiring_status,
   properties_hs_createdate,
   properties_hs_email_open,
   properties_hs_is_contact,
   properties_ip_state_code,
   properties_last_sent_sms,
   properties_opt_in_status,
   properties_program_state,
   properties_rally_user_id,
   properties_total_revenue,
   properties_twitterhandle,
   properties_contacts_rides,
   properties_field_of_study,
   properties_hs_buying_role,
   properties_hs_email_click,
   properties_hs_ip_timezone,
   properties_hs_is_unworked,
   properties_hs_lead_status,
   properties_hs_legal_basis,
   properties_last_call_date,
   properties_last_used_tags,
   properties_lifecyclestage,
   properties_marital_status,
   properties_referral_count,
   properties_sms_opt_in_out,
   properties_total_sent_sms,
   properties_unknown_source,
   properties_upload_a_photo,
   properties_app_suitability,
   properties_completed_event,
   properties_graduation_date,
   properties_hs_all_team_ids,
   properties_hs_email_bounce,
   properties_hs_email_domain,
   properties_hs_email_optout,
   properties_hs_testrollback,
   properties_hs_time_in_lead,
   properties_hs_was_imported,
   properties_hubspot_team_id,
   properties_ip_country_code,
   properties_military_status,
   properties_previous_client,
   properties_dots_payout_link,
   properties_exemption_status,
   properties_hs_all_owner_ids,
   properties_hs_email_replied,
   properties_hs_latest_source,
   properties_hs_object_source,
   properties_hs_time_in_other,
   properties_hubspot_owner_id,
   properties_last_sms_sent_id,
   properties_lastmodifieddate,
   properties_photo_form_blurb,
   properties_sms_opt_out_date,
   properties_state__dropdown_,
   properties_street_address_2,
   properties_calendly_answer_1,
   properties_calendly_answer_2,
   properties_calendly_answer_3,
   properties_calendly_answer_4,
   properties_calendly_answer_5,
   properties_calendly_answer_6,
   properties_calendly_answer_7,
   properties_calendly_answer_8,
   properties_calendly_answer_9,
   properties_interest__cloned_,
   properties_last_call_outcome,
   properties_last_received_sms,
   properties_mobilizer_s_email,
   properties_program_applicant,
   properties_application_source,
   properties_calendly_answer_10,
   properties_count_no_vote_2019,
   properties_hou_payment_amount,
   properties_hs_count_is_worked,
   properties_hs_email_delivered,
   properties_hs_google_click_id,
   properties_last_activity_date,
   properties_last_sms_sent_date,
   properties_notes_last_updated,
   properties_recent_deal_amount,
   properties_total_received_sms,
   properties_associatedcompanyid,
   properties_calendly_question_1,
   properties_calendly_question_2,
   properties_calendly_question_3,
   properties_calendly_question_4,
   properties_calendly_question_5,
   properties_calendly_question_6,
   properties_calendly_question_7,
   properties_calendly_question_8,
   properties_calendly_question_9,
   properties_currentlyinworkflow,
   properties_eday_evening_voters,
   properties_hs_all_contact_vids,
   properties_hs_analytics_source,
   properties_hs_date_exited_lead,
   properties_hs_lastmodifieddate,
   properties_hs_object_source_id,
   properties_hs_time_in_customer,
   properties_last_contacted_date,
   properties_last_sms_sent_error,
   properties_num_contacted_notes,
   properties_referral_short_link,
   properties_relationship_status,
   properties_calendly_question_10,
   properties_calling_country_code,
   properties_exclude_from_mailing,
   properties_hs_additional_emails,
   properties_hs_analytics_revenue,
   properties_hs_count_is_unworked,
   properties_hs_date_entered_lead,
   properties_hs_date_exited_other,
   properties_hs_email_bad_address,
   properties_hs_email_quarantined,
   properties_hs_facebook_click_id,
   properties_hs_marketable_status,
   properties_hs_merged_object_ids,
   properties_hs_registered_member,
   properties_last_sms_received_id,
   properties_last_sms_sent_number,
   properties_last_sms_sent_status,
   properties_mobilizer___all_time,
   properties_notes_last_contacted,
   properties_num_associated_deals,
   properties_social_media_handles,
   properties_total_sms_sent_count,
   properties_updated_phone_number,
   properties_contacts_no_vote_2019,
   properties_eday_afternoon_voters,
   properties_first_conversion_date,
   properties_hs_analytics_last_url,
   properties_hs_created_by_user_id,
   properties_hs_date_entered_other,
   properties_hs_quarantined_emails,
   properties_hs_time_in_evangelist,
   properties_hs_time_in_subscriber,
   properties_hs_updated_by_user_id,
   properties_num_conversion_events,
   properties_program___referred_by,
   properties_zoom_webinar_joinlink,
   properties_hs_analytics_first_url,
   properties_hs_clicked_linkedin_ad,
   properties_hs_email_is_ineligible,
   properties_hs_facebook_ad_clicked,
   properties_hs_first_outreach_date,
   properties_hs_linkedin_ad_clicked,
   properties_hs_object_source_label,
   properties_hs_registration_method,
   properties_hs_time_in_opportunity,
   properties_hs_unique_creation_key,
   properties_hs_v2_date_exited_lead,
   properties_last_sms_received_date,
   properties_recent_conversion_date,
   properties_recent_deal_close_date,
   properties_first_deal_created_date,
   properties_hs_analytics_num_visits,
   properties_hs_date_exited_customer,
   properties_hs_email_last_open_date,
   properties_hs_email_last_send_date,
   properties_hs_latest_source_data_1,
   properties_hs_latest_source_data_2,
   properties_hs_marketable_reason_id,
   properties_hs_pinned_engagement_id,
   properties_hs_v2_date_entered_lead,
   properties_hs_v2_date_exited_other,
   properties_last_sms_received_error,
   properties_mobilizer_program_state,
   properties_rally_client___all_time,
   properties_referred_by__record_id_,
   properties_webinareventlastupdated,
   properties_contacts_with_vote_plans,
   properties_exemption_status___other,
   properties_flag_fall_applicant_2024,
   properties_hs_date_entered_customer,
   properties_hs_email_first_open_date,
   properties_hs_email_first_send_date,
   properties_hs_email_last_click_date,
   properties_hs_email_last_email_name,
   properties_hs_email_last_reply_date,
   properties_hs_email_optout_83740904,
   properties_hs_email_optout_83763159,
   properties_hs_latest_open_lead_date,
   properties_hs_object_source_user_id,
   properties_hs_sequences_is_enrolled,
   properties_hs_v2_date_entered_other,
   properties_hs_whatsapp_phone_number,
   properties_last_sms_received_number,
   properties_last_sms_received_status,
   properties_notes_next_activity_date,
   properties_state__dropdown___sales_,
   properties_total_sms_received_count,
   properties_what_best_describes_you_,
   properties_contacts_with_vote_plans2,
   properties_hou___language_preference,
   properties_hs_avatar_filemanager_key,
   properties_hs_calculated_merged_vids,
   properties_hs_date_exited_evangelist,
   properties_hs_date_exited_subscriber,
   properties_hs_email_first_click_date,
   properties_hs_email_first_reply_date,
   properties_hs_email_optout_215049510,
   properties_hs_email_optout_246710480,
   properties_hs_email_optout_371779325,
   properties_hs_marketable_reason_type,
   properties_hs_mobile_sdk_push_tokens,
   properties_hs_object_source_detail_1,
   properties_hs_object_source_detail_2,
   properties_hs_object_source_detail_3,
   properties_hs_user_ids_of_all_owners,
   properties_hs_v2_latest_time_in_lead,
   properties_incident_report_reasoning,
   properties_last_inbound_message_body,
   properties_hs_all_accessible_team_ids,
   properties_hs_analytics_last_referrer,
   properties_hs_analytics_source_data_1,
   properties_hs_analytics_source_data_2,
   properties_hs_calculated_phone_number,
   properties_hs_date_entered_evangelist,
   properties_hs_date_entered_subscriber,
   properties_hs_date_exited_opportunity,
   properties_hs_document_last_revisited,
   properties_hs_emailconfirmationstatus,
   properties_hs_has_active_subscription,
   properties_hs_latest_meeting_activity,
   properties_hs_latest_source_timestamp,
   properties_hs_sales_email_last_opened,
   properties_hs_v2_date_exited_customer,
   properties_hs_v2_latest_time_in_other,
   properties_hubspot_owner_assigneddate,
   properties_last_outbound_message_body,
   properties_ms_application_suitability,
   properties_first_conversion_event_name,
   properties_hou_application_suitability,
   properties_hs_analytics_first_referrer,
   properties_hs_analytics_last_timestamp,
   properties_hs_analytics_num_page_views,
   properties_hs_calculated_mobile_number,
   properties_hs_content_membership_email,
   properties_hs_content_membership_notes,
   properties_hs_created_by_conversations,
   properties_hs_date_entered_opportunity,
   properties_hs_email_hard_bounce_reason,
   properties_hs_email_quarantined_reason,
   properties_hs_feedback_last_nps_rating,
   properties_hs_last_sales_activity_date,
   properties_hs_last_sales_activity_type,
   properties_hs_latest_sequence_enrolled,
   properties_hs_lifecyclestage_lead_date,
   properties_hs_marketable_until_renewal,
   properties_hs_notes_next_activity_type,
   properties_hs_sa_first_engagement_date,
   properties_hs_sales_email_last_clicked,
   properties_hs_sales_email_last_replied,
   properties_hs_sequences_enrolled_count,
   properties_hs_time_to_first_engagement,
   properties_hs_v2_date_entered_customer,
   properties_incident_report_file_upload,
   properties_last_used_call_phone_number,
   properties_user_campaign_membership_id,
   properties_what_are_you_interested_in_,
   properties_associatedcompanylastupdated,
   properties_hs_analytics_first_timestamp,
   properties_hs_content_membership_status,
   properties_hs_feedback_last_survey_date,
   properties_hs_lifecyclestage_other_date,
   properties_hs_sa_first_engagement_descr,
   properties_hs_v2_date_exited_evangelist,
   properties_hs_v2_date_exited_subscriber,
   properties_num_unique_conversion_events,
   properties_recent_conversion_event_name,
   properties_surveymonkeyeventlastupdated,
   properties_how_did_you_hear_about_rally_,
   properties_hs_associated_target_accounts,
   properties_hs_first_engagement_object_id,
   properties_hs_latest_qualified_lead_date,
   properties_hs_latest_sequence_ended_date,
   properties_hs_time_in_salesqualifiedlead,
   properties_hs_v2_cumulative_time_in_lead,
   properties_hs_v2_date_entered_evangelist,
   properties_hs_v2_date_entered_subscriber,
   properties_hs_v2_date_exited_opportunity,
   properties_hs_v2_latest_time_in_customer,
   properties_last_message_received_content,
   properties_zoom_webinar_attendance_count,
   properties_count_contacts_with_vote_plans,
   properties_deal_record_id___for_referrals,
   properties_hs_calculated_form_submissions,
   properties_hs_conversations_visitor_email,
   properties_hs_feedback_last_nps_follow_up,
   properties_hs_v2_cumulative_time_in_other,
   properties_hs_v2_date_entered_opportunity,
   properties_unenroll_as_marketing_contact_,
   properties_engagements_last_meeting_booked,
   properties_hs_analytics_average_page_views,
   properties_hs_feedback_show_nps_web_survey,
   properties_hs_lifecyclestage_customer_date,
   properties_hs_v2_latest_time_in_evangelist,
   properties_hs_v2_latest_time_in_subscriber,
   properties_n11_7_23_2019_nonvoter_contacts,
   properties_zoom_webinar_registration_count,
   properties_hs_email_hard_bounce_reason_enum,
   properties_hs_last_sales_activity_timestamp,
   properties_hs_latest_disqualified_lead_date,
   properties_hs_latest_sequence_enrolled_date,
   properties_hs_latest_sequence_finished_date,
   properties_hs_v2_latest_time_in_opportunity,
   properties_state__for_website_inquiry_form_,
   properties_hs_analytics_last_visit_timestamp,
   properties_hs_date_exited_salesqualifiedlead,
   properties_hs_first_subscription_create_date,
   properties_hs_lifecyclestage_evangelist_date,
   properties_hs_lifecyclestage_subscriber_date,
   properties_hs_time_in_marketingqualifiedlead,
   properties_hs_v2_cumulative_time_in_customer,
   properties_anything_else_you_d_like_to_share_,
   properties_hs_analytics_first_visit_timestamp,
   properties_hs_analytics_num_event_completions,
   properties_hs_date_entered_salesqualifiedlead,
   properties_hs_latest_sequence_unenrolled_date,
   properties_hs_latest_subscription_create_date,
   properties_hs_lifecyclestage_opportunity_date,
   properties_hs_sa_first_engagement_object_type,
   properties_hs_content_membership_registered_at,
   properties_hs_v2_cumulative_time_in_evangelist,
   properties_hs_v2_cumulative_time_in_subscriber,
   properties_contacts_without_complete_vote_plans,
   properties_hs_calculated_phone_number_area_code,
   properties_hs_email_customer_quarantined_reason,
   properties_hs_email_sends_since_last_engagement,
   properties_hs_sequences_actively_enrolled_count,
   properties_hs_v2_cumulative_time_in_opportunity,
   properties_hs_v2_date_exited_salesqualifiedlead,
   properties_placeholder_app_suitability_question,
   properties_what_privacy_request_are_you_making_,
   properties_hs_content_membership_email_confirmed,
   properties_hs_date_exited_marketingqualifiedlead,
   properties_hs_searchable_calculated_phone_number,
   properties_hs_time_to_move_from_lead_to_customer,
   properties_hs_v2_date_entered_salesqualifiedlead,
   properties_initial_zoom_webinar_attendance_count,
   properties_engagements_last_meeting_booked_medium,
   properties_engagements_last_meeting_booked_source,
   properties_hs_calculated_phone_number_region_code,
   properties_hs_date_entered_marketingqualifiedlead,
   properties_hs_searchable_calculated_mobile_number,
   properties_hs_calculated_phone_number_country_code,
   properties_hs_v2_latest_time_in_salesqualifiedlead,
   properties_initial_zoom_webinar_registration_count,
   properties_engagements_last_meeting_booked_campaign,
   properties_hs_v2_date_exited_marketingqualifiedlead,
   properties_state___other__for_website_inquiry_form_,
   properties_zoom_webinar_attendance_average_duration,
   properties_hs_lifecyclestage_salesqualifiedlead_date,
   properties_hs_user_ids_of_all_notification_followers,
   properties_hs_v2_date_entered_marketingqualifiedlead,
   properties_incident_report___onboarding_session_date,
   properties_incident_report___onboarding_session_time,
   properties_count_contacts_without_complete_vote_plans,
   properties_hs_membership_has_accessed_private_content,
   properties_hs_analytics_last_touch_converting_campaign,
   properties_hs_content_membership_follow_up_enqueued_at,
   properties_hs_time_to_move_from_subscriber_to_customer,
   properties_hs_user_ids_of_all_notification_unfollowers,
   properties_hs_v2_cumulative_time_in_salesqualifiedlead,
   properties_hs_v2_latest_time_in_marketingqualifiedlead,
   properties_hs_analytics_first_touch_converting_campaign,
   properties_hs_prospecting_agent_actively_enrolled_count,
   properties_hs_time_to_move_from_opportunity_to_customer,
   properties_hs_lifecyclestage_marketingqualifiedlead_date,
   properties_hs_membership_last_private_content_access_date,
   properties_hs_time_between_contact_creation_and_deal_close,
   properties_hs_v2_cumulative_time_in_marketingqualifiedlead,
   properties_hs_content_membership_registration_email_sent_at,
   properties_initial_zoom_webinar_attendance_average_duration,
   properties_hs_content_membership_registration_domain_sent_to,
   properties_hs_time_between_contact_creation_and_deal_creation,
   properties_hs_searchable_calculated_international_phone_number,
   properties_hs_time_to_move_from_salesqualifiedlead_to_customer,
   properties_please_read_and_select_the_applicable_option_below_,
   properties_hs_searchable_calculated_international_mobile_number,
   properties_hs_time_to_move_from_marketingqualifiedlead_to_customer,
   properties_how_important_do_you_believe_protecting_the_environment_is_,
   properties_why_are_you_interested_in_being_part_of_presley_ambassadors_,
   properties_why_are_you_interested_in_being_part_of_the_capitanes_por_cambio_program_,
   properties_please_provide_any_additional_information_that_is_relevant_to_your_request_,
   properties_what_is_the_name_of_the_campaign_in_rally_that_you_are_primarily_engaged_with_,
   properties_a_big_issue_in_the_news_recently_has_been_the_right_to_get_an_abortion__what_do_you_think_,
   properties_i_acknowledge_that_i_have_chosen_to_delete_my_account__this_will_cause_you_to_lose_access_to_rally_,
   properties_i_acknowledge_that_transmitting_personal_information_over_the_internet_or_via_mail_comes_with_inher,
   properties_please_explain_in_detail_what_information_you_would_like_to_correct_so_we_can_complete_your_request,
   properties_please_provide_any_information_that_might_be_helpful_in_fulfilling_your_request_in_regards_to_how_y,
   properties_tell_us_a_bit_more_about_you__what_s_the_size_of_the_district_you_re_working_in__what_is_your_role_,
   {{ dbt_utils.surrogate_key([
     'vid',
    'property',
    'timestamp',
    ]) }} as _airbyte_contacts_property_history_hashid
from {{ source('cta', 'contacts_property_history') }}
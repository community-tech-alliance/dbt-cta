
{{ config(
    cluster_by = "_airbyte_extracted_at",
    partition_by = {"field": "_airbyte_extracted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_raw_id'
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ source('cta', 'goals') }}

select
   _airbyte_raw_id,
   _airbyte_extracted_at,
   _airbyte_meta,
   _airbyte_generation_id,
   id,
   archived,
   createdAt,
   updatedAt,
   properties,
   properties_hs_status,
   properties_hs_outcome,
   properties_hs_team_id,
   properties_hs_user_id,
   properties_hs_currency,
   properties_hs_end_date,
   properties_hs_goal_name,
   properties_hs_goal_type,
   properties_hs_is_legacy,
   properties_hs_kpi_value,
   properties_hs_milestone,
   properties_hs_object_id,
   properties_hs_pipelines,
   properties_hs_read_only,
   properties_hs_createdate,
   properties_hs_start_date,
   properties_hs_template_id,
   properties_hs_all_team_ids,
   properties_hs_end_datetime,
   properties_hs_was_imported,
   properties_hubspot_team_id,
   properties_hs_all_owner_ids,
   properties_hs_kpi_unit_type,
   properties_hs_legacy_active,
   properties_hs_legacy_sql_id,
   properties_hs_object_source,
   properties_hs_target_amount,
   properties_hubspot_owner_id,
   properties_hs_start_datetime,
   properties_hs_is_forecastable,
   properties_hs_kpi_metric_type,
   properties_hs_kpi_object_type,
   properties_hs_shared_team_ids,
   properties_hs_shared_user_ids,
   properties_hs_assignee_team_id,
   properties_hs_assignee_user_id,
   properties_hs_forecast_type_id,
   properties_hs_kpi_display_unit,
   properties_hs_lastmodifieddate,
   properties_hs_object_source_id,
   properties_hs_deal_pipeline_ids,
   properties_hs_kpi_filter_groups,
   properties_hs_kpi_property_name,
   properties_hs_legacy_created_at,
   properties_hs_legacy_created_by,
   properties_hs_legacy_updated_at,
   properties_hs_legacy_updated_by,
   properties_hs_merged_object_ids,
   properties_hs_created_by_user_id,
   properties_hs_fiscal_year_offset,
   properties_hs_kpi_is_team_rollup,
   properties_hs_kpi_object_type_id,
   properties_hs_should_recalculate,
   properties_hs_updated_by_user_id,
   properties_hs_goal_definition_key,
   properties_hs_kpi_tracking_method,
   properties_hs_object_source_label,
   properties_hs_ticket_pipeline_ids,
   properties_hs_unique_creation_key,
   properties_hs_ad_account_asset_ids,
   properties_hs_goal_target_group_id,
   properties_hs_kpi_progress_percent,
   properties_hs_legacy_unique_sql_id,
   properties_hs_status_display_order,
   properties_hs_ad_campaign_asset_ids,
   properties_hs_migration_soft_delete,
   properties_hs_object_source_user_id,
   properties_hs__migration_soft_delete,
   properties_hs_group_correlation_uuid,
   properties_hs_object_source_detail_1,
   properties_hs_object_source_detail_2,
   properties_hs_object_source_detail_3,
   properties_hs_user_ids_of_all_owners,
   properties_hs_all_accessible_team_ids,
   properties_hs_contact_lifecycle_stage,
   properties_hs_kpi_value_calculated_at,
   properties_hs_owner_ids_of_all_owners,
   properties_hs_should_notify_on_missed,
   properties_hubspot_owner_assigneddate,
   properties_hs_kpi_time_period_property,
   properties_hs_should_notify_on_kickoff,
   properties_hs_static_kpi_filter_groups,
   properties_hs_should_notify_on_achieved,
   properties_hs_should_notify_on_exceeded,
   properties_hs_kpi_value_last_calculated_at,
   properties_hs_goal_definition_key_with_team,
   properties_hs_goal_definition_key_with_user,
   properties_hs_marketing_campaign_object_ids,
   properties_hs_should_notify_on_edit_updates,
   properties_hs_all_assigned_business_unit_ids,
   properties_hs_target_amount_in_home_currency,
   properties_hs_should_notify_on_progress_updates,
   properties_hs_kpi_filter_groups_for_key_grouping,
   properties_hs_edit_updates_notification_frequency,
   properties_hs_legacy_quarterly_target_composite_id,
   properties_hs_user_ids_of_all_notification_followers,
   properties_hs_kpi_filter_groups_for_key_team_grouping,
   properties_hs_kpi_single_object_custom_goal_type_name,
   properties_hs_progress_updates_notification_frequency,
   properties_hs_user_ids_of_all_notification_unfollowers,
   {{ dbt_utils.surrogate_key([
     'id',
    'archived',
    'createdAt',
    'updatedAt',
    'properties_hs_status',
    'properties_hs_outcome',
    'properties_hs_currency',
    'properties_hs_end_date',
    'properties_hs_goal_name',
    'properties_hs_goal_type',
    'properties_hs_is_legacy',
    'properties_hs_milestone',
    'properties_hs_pipelines',
    'properties_hs_read_only',
    'properties_hs_createdate',
    'properties_hs_start_date',
    'properties_hs_all_team_ids',
    'properties_hs_end_datetime',
    'properties_hs_was_imported',
    'properties_hubspot_team_id',
    'properties_hs_all_owner_ids',
    'properties_hs_kpi_unit_type',
    'properties_hs_legacy_active',
    'properties_hs_object_source',
    'properties_hubspot_owner_id',
    'properties_hs_start_datetime',
    'properties_hs_is_forecastable',
    'properties_hs_kpi_metric_type',
    'properties_hs_kpi_object_type',
    'properties_hs_shared_team_ids',
    'properties_hs_shared_user_ids',
    'properties_hs_kpi_display_unit',
    'properties_hs_lastmodifieddate',
    'properties_hs_object_source_id',
    'properties_hs_deal_pipeline_ids',
    'properties_hs_kpi_filter_groups',
    'properties_hs_kpi_property_name',
    'properties_hs_merged_object_ids',
    'properties_hs_kpi_is_team_rollup',
    'properties_hs_kpi_object_type_id',
    'properties_hs_should_recalculate',
    'properties_hs_goal_definition_key',
    'properties_hs_kpi_tracking_method',
    'properties_hs_object_source_label',
    'properties_hs_ticket_pipeline_ids',
    'properties_hs_unique_creation_key',
    'properties_hs_ad_account_asset_ids',
    'properties_hs_ad_campaign_asset_ids',
    'properties_hs_migration_soft_delete',
    'properties_hs__migration_soft_delete',
    'properties_hs_group_correlation_uuid',
    'properties_hs_object_source_detail_1',
    'properties_hs_object_source_detail_2',
    'properties_hs_object_source_detail_3',
    'properties_hs_user_ids_of_all_owners',
    'properties_hs_all_accessible_team_ids',
    'properties_hs_contact_lifecycle_stage',
    'properties_hs_owner_ids_of_all_owners',
    'properties_hs_should_notify_on_missed',
    'properties_hubspot_owner_assigneddate',
    'properties_hs_kpi_time_period_property',
    'properties_hs_should_notify_on_kickoff',
    'properties_hs_static_kpi_filter_groups',
    'properties_hs_should_notify_on_achieved',
    'properties_hs_should_notify_on_exceeded',
    'properties_hs_kpi_value_last_calculated_at',
    'properties_hs_goal_definition_key_with_team',
    'properties_hs_goal_definition_key_with_user',
    'properties_hs_should_notify_on_edit_updates',
    'properties_hs_all_assigned_business_unit_ids',
    'properties_hs_should_notify_on_progress_updates',
    'properties_hs_kpi_filter_groups_for_key_grouping',
    'properties_hs_edit_updates_notification_frequency',
    'properties_hs_legacy_quarterly_target_composite_id',
    'properties_hs_user_ids_of_all_notification_followers',
    'properties_hs_kpi_filter_groups_for_key_team_grouping',
    'properties_hs_kpi_single_object_custom_goal_type_name',
    'properties_hs_progress_updates_notification_frequency',
    'properties_hs_user_ids_of_all_notification_unfollowers'
    ]) }} as _airbyte_goals_hashid
from {{ source('cta', 'goals') }}
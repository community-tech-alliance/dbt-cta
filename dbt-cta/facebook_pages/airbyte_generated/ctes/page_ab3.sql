{{ config(
    cluster_by = "_airbyte_emitted_at",
    partition_by = {"field": "_airbyte_emitted_at", "data_type": "timestamp", "granularity": "day"},
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_default",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to build a hash column based on the values of this record
-- depends_on: {{ ref('page_ab2') }}
select
    {{ dbt_utils.surrogate_key([
        'name_with_location_descriptor',
        'attire',
        object_to_string('messaging_feature_status'),
        object_to_string('subscribed_apps'),
        'about',
        object_to_string('videos'),
        object_to_string('published_posts'),
        object_to_string('cover'),
        'culinary_team',
        object_to_string('tagged'),
        'app_id',
        boolean_to_string('is_community_page'),
        object_to_string('events'),
        object_to_string('custom_labels'),
        boolean_to_string('offer_eligible'),
        object_to_string('messaging_feature_review'),
        'global_brand_page_name',
        object_to_string('personas'),
        object_to_string('page_backed_instagram_accounts'),
        object_to_string('image_copyrights'),
        'mission',
        'release_date',
        'global_brand_root_id',
        object_to_string('connected_instagram_account'),
        'store_number',
        'description_html',
        object_to_string('instagram_accounts'),
        object_to_string('albums'),
        object_to_string('nativeoffers'),
        'leadgen_tos_acceptance_time',
        object_to_string('mini_shop_storefront'),
        object_to_string('ads_posts'),
        'new_like_count',
        'genre',
        'record_label',
        object_to_string('start_info'),
        'store_code',
        'website',
        object_to_string('global_brand_children'),
        object_to_string('canvas_elements'),
        'differently_open_offerings',
        'business',
        'founded',
        boolean_to_string('is_owned'),
        'privacy_info_url',
        'company_overview',
        'unread_message_count',
        object_to_string('indexed_videos'),
        object_to_string('restaurant_specialties'),
        'single_line_address',
        'promotion_ineligible_reason',
        'checkins',
        array_to_string('pickup_options'),
        'written_by',
        object_to_string('crosspost_whitelisted_pages'),
        object_to_string('engagement'),
        'keywords',
        'overall_star_rating',
        'price_range',
        'pharma_safety_info',
        'features',
        'affiliation',
        'whatsapp_number',
        'current_location',
        object_to_string('instagram_business_account'),
        'fan_count',
        'talking_about_count',
        object_to_string('live_videos'),
        'name',
        'produced_by',
        boolean_to_string('is_webhooks_subscribed'),
        'booking_agent',
        object_to_string('custom_user_settings'),
        boolean_to_string('can_checkin'),
        object_to_string('roles'),
        'description',
        object_to_string('voip_info'),
        'merchant_id',
        array_to_string('emails'),
        object_to_string('messenger_profile'),
        boolean_to_string('supports_instant_articles'),
        object_to_string('ratings'),
        'display_subtext',
        object_to_string('copyright_whitelisted_partners'),
        object_to_string('best_page'),
        object_to_string('contact_address'),
        'hours',
        'hometown',
        'screenplay_by',
        boolean_to_string('is_always_open'),
        array_to_string('delivery_and_pickup_option_info'),
        object_to_string('secondary_receivers'),
        object_to_string('agencies'),
        object_to_string('commerce_payouts'),
        object_to_string('media_fingerprints'),
        boolean_to_string('is_eligible_for_branded_content'),
        'schedule',
        object_to_string('admin_notes'),
        boolean_to_string('is_unclaimed'),
        'followers_count',
        'recipient',
        object_to_string('location'),
        object_to_string('video_lists'),
        'username',
        'were_here_count',
        'studio',
        object_to_string('parking'),
        object_to_string('visitor_posts'),
        array_to_string('food_styles'),
        object_to_string('restaurant_services'),
        boolean_to_string('is_published'),
        'bio',
        boolean_to_string('has_whatsapp_number'),
        'displayed_message_response_time',
        boolean_to_string('is_permanently_closed'),
        object_to_string('chat_plugin'),
        'public_transit',
        array_to_string('category_list'),
        boolean_to_string('is_messenger_bot_get_started_enabled'),
        object_to_string('claimed_urls'),
        array_to_string('copyright_whitelisted_ig_partners'),
        'season',
        'store_location_descriptor',
        object_to_string('leadgen_tos_accepting_user'),
        'id',
        'band_members',
        object_to_string('payment_options'),
        object_to_string('instant_articles_insights'),
        'mpg',
        object_to_string('shop_setup_status'),
        'access_token',
        object_to_string('product_catalogs'),
        object_to_string('commerce_orders'),
        'phone',
        'instant_articles_review_status',
        object_to_string('commerce_eligibility'),
        'country_page_likes',
        object_to_string('video_copyright_rules'),
        object_to_string('tabs'),
        'plot_outline',
        object_to_string('leadgen_forms'),
        'products',
        object_to_string('commerce_transactions'),
        object_to_string('blocked'),
        boolean_to_string('promotion_eligible'),
        array_to_string('messenger_ads_default_quick_replies'),
        'place_type',
        'general_manager',
        boolean_to_string('supports_donate_button_in_live_video'),
        boolean_to_string('is_verified'),
        object_to_string('scheduled_posts'),
        object_to_string('picture'),
        'artists_we_like',
        'page_token',
        object_to_string('rtb_dynamic_posts'),
        object_to_string('parent_page'),
        object_to_string('call_to_actions'),
        object_to_string('posts'),
        object_to_string('photos'),
        'impressum',
        'press_contact',
        'band_interests',
        boolean_to_string('has_whatsapp_business_number'),
        'members',
        boolean_to_string('has_added_app'),
        object_to_string('likes'),
        'personal_interests',
        object_to_string('settings'),
        object_to_string('insights'),
        object_to_string('assigned_users'),
        'merchant_review_status',
        object_to_string('connected_page_backed_instagram_account'),
        'rating_count',
        object_to_string('feed'),
        object_to_string('canvases'),
        object_to_string('featured_video'),
        boolean_to_string('is_messenger_platform_bot'),
        object_to_string('commerce_merchant_settings'),
        'birthday',
        boolean_to_string('has_transitioned_to_new_page_experience'),
        object_to_string('instant_articles'),
        'link',
        object_to_string('ad_campaign'),
        'verification_status',
        object_to_string('conversations'),
        'network',
        'directed_by',
        'personal_info',
        'influences',
        'general_info',
        boolean_to_string('can_post'),
        object_to_string('preferred_audience'),
        'temporary_status',
        boolean_to_string('is_chain'),
        'built',
        object_to_string(adapter.quote('groups')),
        object_to_string('threads'),
        'messenger_ads_quick_replies_type',
        object_to_string('thread_owner'),
        'awards',
        'starring',
        array_to_string('messenger_ads_default_icebreakers'),
        object_to_string('locations'),
        'unseen_message_count',
        'category',
        'unread_notif_count',
        boolean_to_string('leadgen_tos_accepted'),
    ]) }} as _airbyte_page_hashid,
    tmp.*
from {{ ref('page_ab2') }} tmp
-- page
where 1 = 1


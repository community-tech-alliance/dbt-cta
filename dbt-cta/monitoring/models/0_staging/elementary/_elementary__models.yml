version: 2

models:

  - name: stg_elementary__dbt_run_results
    description: >
      A staging model of the elementary-generated dbt_run_results table. This table also
      extracts the "sync_name", "partner_name", and "airflow_run_id" from the json
      column containing the dbt vars for a given invocation.
    columns:
      - name: model_execution_id
        description: >
          The unique identifier for this dbt model run.
        tests:
          - not_null
          - unique
      - name: execute_started_at
        description: >
          The timestamp at which this dbt run started.
      - name: execute_completed_at
        description: >
          The timestamp at which this dbt run finished.
      - name: status
        description: >
          The status of this dbt run.
        tests:
          - not_null
      - name: sync_name
        description: >
          The name of the sync that this dbt run is a part of.
      - name: partner_name
        description: >
          The name of the partner that this dbt project was run for
      - name: airflow_run_id
        description: >
          The airflow run id that this dbt run was a part of.

  - name: stg_elementary__dbt_invocations
      A staging model of the elementary-generated dbt_invocations table.
    columns:
      - name: invocation_id
        description: >
          The unique identifier for this dbt invocation.
        tests:
          - not_null
          - unique
      - name: selected
        description: >
          A cleaned up value of the "selected" field, replacing characters with
          underscrores.
      - name: invocation_type
        description: >
          A calculated field that tells us what type of dbt invocation this was,
          generally one of the following:
            - '0 - Test CTA Sources'
            - '1 - Build CTA Models'
            - '2 - Test CTA Models'
            - '3 - Test Partner Sources'
            - '4 - Build Partner Models'
            - '5 - Test Partner Models'